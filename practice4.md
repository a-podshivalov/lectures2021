# Практическое занятие 3: LoRaWAN и энергосберегающие режимы

В качестве "скелета" для приложения под RIOT, работающего с LoRaWAN, можно использовать пример `examples-miem/lorawan`. Для отправки данных без использования MAC-уровня можно использовать пример `examples-miem/lora'.

## Задания

1. (2) Спецификация LoRaWAN требует, чтобы интервалы между повторными попытками передачи данных или JoinRequest выбирались случайным образом. Добавьте эти возможности в приложение.

1. (1) Скачайте симулятор NS-3 (https://www.nsnam.org) и постройте в нем имитацию сети WiFi (один из примеров в его tutorial). Постройте в симуляторе имитацию сети LoRaWAN, используя соответствующий модуль (https://github.com/signetlabdei/lorawan).

1. (3) Добавьте в симулятор LoRaWAN нереализованные в нем возможности из спецификации (например, устройства классов B и C) или измените каким-либо логичным образом поведение сетевого сервера, сравните результаты с "обычными".

1. (3) В модуле LoRaWAN для операционной системы mbed отсутствует поддержка частотного плана RU864. Добавьте ее. (10) Добейтесь принятия ваших изменений в upstream.

1. (4) Сформируйте пакет, выводящий из строя устройства со старой версий Riot (посмотрите содержимое коммита `fffe8bb7328a61ab9756b28089c4f987a7f46f53`, из него должно быть ясно, в чем проблема). *Внимание!* Этот пакет должен передаваться на частоте, не внесенной в частотные планы LoRaWAN EU868 и RU864, например, можно использовать 869,000 МГц.

1. (4) Описана "атака" на автосигнализацию со счетчиком переданных сообщений, в которой злоумышленник имеет возможность глушить передачи данных от брелка, а также записывать и воспроизводить их. Представьте себе аналогично устроенный "умный замок" для LoRaWAN - открывающийся, например, при получении пакета с заранее определенным payload (например, четыре байта "open"). Подвержен ли он подобной атаке? Если нет - объясните, почему, если да - продемонстрируйте устройство, осуществляющее аналогичные действия.

1. (2-4) Добавьте работу с радиосетью к любому из устройств в первом и втором блоках заданий (светофор, сейф, датчики, ...).

1. (2) Отключите различные оптимизации энергосберегающих режимов, проверьте поведение микроконтроллера и подключенных устройств в этих случаях.